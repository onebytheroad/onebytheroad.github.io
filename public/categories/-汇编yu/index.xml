<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>-汇编yu on 雫的小站</title>
        <link>http://localhost:1313/categories/-%E6%B1%87%E7%BC%96yu/</link>
        <description>Recent content in -汇编yu on 雫的小站</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>zh-cn</language>
        <copyright>Example Person</copyright>
        <lastBuildDate>Sun, 07 Dec 2025 00:00:00 +0000</lastBuildDate><atom:link href="http://localhost:1313/categories/-%E6%B1%87%E7%BC%96yu/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>12-07 笔记</title>
        <link>http://localhost:1313/p/12-07/</link>
        <pubDate>Sun, 07 Dec 2025 00:00:00 +0000</pubDate>
        
        <guid>http://localhost:1313/p/12-07/</guid>
        <description>&lt;img src="http://localhost:1313/bj.jpg" alt="Featured image of post 12-07 笔记" /&gt;&lt;p&gt;111&lt;/p&gt;
&lt;p&gt;函数的ABI规范&lt;/p&gt;
&lt;p&gt;- 参数通过 &lt;code&gt;rdi, rsi, rdx...&lt;/code&gt; 传递
- 返回值在 &lt;code&gt;rax&lt;/code&gt;
- &lt;code&gt;rbx, rbp, r12–r15&lt;/code&gt; 是 callee-saved，其余是 caller-saved&lt;/p&gt;
&lt;p&gt;寄存器的分类&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;&lt;strong&gt;参数/返回&lt;/strong&gt;&lt;/th&gt;
          &lt;th&gt;&lt;code&gt;rdi&lt;/code&gt;, &lt;code&gt;rsi&lt;/code&gt;, &lt;code&gt;rdx&lt;/code&gt;, &lt;code&gt;rcx&lt;/code&gt;, &lt;code&gt;r8&lt;/code&gt;, &lt;code&gt;r9&lt;/code&gt;, &lt;code&gt;rax&lt;/code&gt;&lt;/th&gt;
          &lt;th&gt;传参 + 返回值&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;callee-saved&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;rbx&lt;/code&gt;, &lt;code&gt;rbp&lt;/code&gt;, &lt;code&gt;r12–r15&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;可安全用于保存中间值&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;临时（caller-saved）&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;r10&lt;/code&gt;, &lt;code&gt;r11&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;自由使用，调用函数后可能被破坏&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;使用地址中的参数，注意要求导入的数据长度&lt;/p&gt;
&lt;p&gt;多个参数的传递：&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;参数序号&lt;/th&gt;
          &lt;th&gt;寄存器（64位）&lt;/th&gt;
          &lt;th&gt;32位形式&lt;/th&gt;
          &lt;th&gt;用途说明&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;第1个&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;rdi&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;edi&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;常用于目标地址（如 &lt;code&gt;dest&lt;/code&gt;）&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;第2个&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;rsi&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;esi&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;常用于源地址（如 &lt;code&gt;src&lt;/code&gt;）&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;第3个&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;rdx&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;edx&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;数据、长度等&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;第4个&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;rcx&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;ecx&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;计数、标志等&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;第5个&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;r8&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;r8d&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;—&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;第6个&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;r9&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;r9d&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;—&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;超过6个则需要使用栈传递（注意保持16字节对齐）&lt;/p&gt;
&lt;p&gt;浮点数用XMM寄存器&lt;/p&gt;
&lt;p&gt;函数中用栈使用数组时，需要对其清零&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;mov rcx, 0
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;clear_loop:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    mov word ptr [rsp + rcx*2], 0
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    inc rcx
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    cmp rcx, 256
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    jl clear_loop
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;循环清零计数器，处理完rsp设定字节
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;IDA:&lt;/p&gt;
&lt;p&gt;字符串定位&lt;/p&gt;
&lt;p&gt;view -&amp;gt; open subviews -&amp;gt; strings&lt;/p&gt;
&lt;p&gt;交叉引用窗口，找出什么代码使用了这个字符串&lt;/p&gt;
&lt;p&gt;&lt;code&gt;X&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;tab,F5 反汇编，&lt;/p&gt;
&lt;p&gt;编译过程中给函数命的名会变为数字，反汇编窗口中可以进行重新命名,右键rename&lt;/p&gt;
&lt;p&gt;左边框 ctrl + f 直接搜索函数名&lt;/p&gt;
&lt;p&gt;如果有不可见字符，ida一般会用一个名字来代替返回的字符串&lt;/p&gt;
&lt;p&gt;提取数据 lazyida&lt;/p&gt;
&lt;p&gt;R键可以切换&lt;/p&gt;
&lt;p&gt;基础加密：凯撒加密，异或加密&lt;/p&gt;
&lt;p&gt;base64编码（使用64个可打印字符编码所有的数据）逆向，根据特征常量确定标准算法&lt;/p&gt;
&lt;p&gt;特征常量，不变的字符串，&lt;/p&gt;
&lt;p&gt;base64编码变表逆向&lt;/p&gt;
&lt;p&gt;魔改表，利用base64编码原理，&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;data = &amp;#39;&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;a = T5[T4.data(ch)]
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在原编码表中找魔改码的位置，然后打印&lt;/p&gt;
&lt;p&gt;ida 动态调试&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://localhost:1313/tiaoshiidad.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;tiaoshiidad&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;不依赖于外部输入，每次输入后程序内部调取加密的字符串&lt;/p&gt;
&lt;p&gt;执行程序，在12行处中断然后看str是什么&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://localhost:1313/debugchuangk.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;debugchuangk&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;伪代码，寄存器，内存，栈&lt;/p&gt;
&lt;p&gt;断点F2，步入F7，步过F8&lt;/p&gt;
&lt;p&gt;利用动态调试观察某一些加密函数的返回值来判断加密类型&lt;/p&gt;
</description>
        </item>
        
    </channel>
</rss>
