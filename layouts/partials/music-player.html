<div id="global-music-player" style="position: fixed; bottom: 20px; right: 20px; z-index: 99999; background: red; border: 3px solid blue; padding: 15px;">
    <audio id="bgMusic" loop>
        <source src="/music/background.mp3" type="audio/mpeg">
    </audio>
    
    <button id="musicToggle" style="background: green; color: white; border: none; padding: 15px 20px; border-radius: 50%; cursor: pointer; font-size: 20px;">
        ðŸŽµ æ’­æ”¾
    </button>
    
    <div id="musicStatus" style="margin-top: 10px; font-size: 14px; color: black; font-weight: bold;">
        ç‚¹å‡»æ’­æ”¾
    </div>
</div>

<script>
// å…¨å±€éŸ³ä¹æ’­æ”¾å™¨
document.addEventListener('DOMContentLoaded', function() {
    const audio = document.getElementById('bgMusic');
    const toggleBtn = document.getElementById('musicToggle');
    const status = document.getElementById('musicStatus');
    
    // ä»ŽlocalStorageæ¢å¤çŠ¶æ€
    const savedState = localStorage.getItem('globalMusicState');
    
    if (savedState === 'playing') {
        // è‡ªåŠ¨æ¢å¤æ’­æ”¾
        setTimeout(() => {
            audio.play().then(() => {
                updateButtonState(true);
            });
        }, 500);
    }
    
    function updateButtonState(isPlaying) {
        if (isPlaying) {
            status.textContent = 'ðŸŽ¶ æ’­æ”¾ä¸­...';
            toggleBtn.innerHTML = 'â¸ æš‚åœ';
            toggleBtn.style.background = 'orange';
        } else {
            status.textContent = 'â¹ å·²æš‚åœ';
            toggleBtn.innerHTML = 'ðŸŽµ æ’­æ”¾';
            toggleBtn.style.background = 'green';
        }
    }
    
    toggleBtn.addEventListener('click', function() {
        if (audio.paused) {
            audio.play().then(() => {
                updateButtonState(true);
                localStorage.setItem('globalMusicState', 'playing');
            });
        } else {
            audio.pause();
            updateButtonState(false);
            localStorage.setItem('globalMusicState', 'paused');
        }
    });
});
</script>