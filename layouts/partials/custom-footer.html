<script>
document.addEventListener('DOMContentLoaded', function() {
    // ========== æ–°å¢çš„å¼ºåˆ¶è®¾ç½®ä»£ç  ==========
    // å¼ºåˆ¶æš—è‰²æ¨¡å¼
    document.documentElement.setAttribute('data-scheme', 'dark');
    localStorage.setItem('theme', 'dark');
    
    // å¼ºåˆ¶èƒŒæ™¯å›¾ç‰‡
    const style = document.createElement('style');
    style.textContent = `
        body::before {
            content: '' !important;
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100% !important;
            background-image: url('/img/bj.jpg') !important;
            background-size: cover !important;
            background-position: center !important;
            background-attachment: fixed !important;
            background-repeat: no-repeat !important;
            z-index: -9999 !important;
        }
        :root, :root[data-scheme="light"], :root[data-scheme="dark"] {
            --body-background: transparent !important;
        }
        body {
            background: transparent !important;
        }
    `;
    document.head.appendChild(style);
    console.log('å¼ºåˆ¶æš—è‰²å’ŒèƒŒæ™¯å›¾ç‰‡å·²è®¾ç½®');
    
    // ========== ä½ åŸæœ‰çš„æŒ‰é’®ä»£ç  ==========
    // ç§»é™¤åŸæŒ‰é’®
    const oldSwitcher = document.querySelector('.theme-switcher');
    if (oldSwitcher) {
        oldSwitcher.remove();
    }
    
    // åˆ›å»ºæ–°æŒ‰é’®
    const newSwitcher = document.createElement('div');
    newSwitcher.className = 'theme-switcher';
    newSwitcher.innerHTML = `
        <button class="theme-switcher-btn" style="
            position: fixed;
            left: 20px;
            bottom: 20px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: var(--card-background);
            color: var(--card-text-color-main);
            cursor: pointer;
            z-index: 1000;
            box-shadow: var(--shadow-l2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        ">ğŸŒ™</button>
    `;
    
    document.body.appendChild(newSwitcher);
    
    // æ›´æ–°æŒ‰é’®å›¾æ ‡
    function updateButtonIcon() {
        const isDark = document.documentElement.getAttribute('data-scheme') === 'dark';
        const btn = document.querySelector('.theme-switcher-btn');
        btn.textContent = isDark ? 'â˜€ï¸' : 'ğŸŒ™';
    }
    
    // ç»‘å®šç‚¹å‡»äº‹ä»¶
    document.querySelector('.theme-switcher-btn').onclick = function() {
        const current = document.documentElement.getAttribute('data-scheme');
        const newScheme = current === 'dark' ? 'light' : 'dark';
        
        document.documentElement.setAttribute('data-scheme', newScheme);
        localStorage.setItem('theme', newScheme);
        updateButtonIcon();
        console.log('ä¸»é¢˜åˆ‡æ¢è‡³:', newScheme);
    };
    
    // åˆå§‹æ›´æ–°å›¾æ ‡
    updateButtonIcon();
});
</script>