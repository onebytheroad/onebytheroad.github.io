<script>
// å®‰å…¨ç‰ˆæ¨±èŠ±ç‰¹æ•ˆ - æ— é€’å½’é£Žé™©
(function() {
    'use strict';
    
    // ç­‰å¾…é¡µé¢å®Œå…¨åŠ è½½
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initSakura);
    } else {
        setTimeout(initSakura, 1000);
    }
    
    function initSakura() {
        console.log('åˆå§‹åŒ–å®‰å…¨ç‰ˆæ¨±èŠ±ç‰¹æ•ˆ');
        
        // ç§»é™¤å¯èƒ½å­˜åœ¨çš„æ—§å®¹å™¨
        const oldContainer = document.getElementById('safe-sakura-container');
        if (oldContainer) oldContainer.remove();
        
        // åˆ›å»ºå®¹å™¨
        const container = document.createElement('div');
        container.id = 'safe-sakura-container';
        container.style.cssText = `
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9998;
            overflow: hidden;
        `;
        document.body.appendChild(container);
        
        // æ·»åŠ æ ·å¼
        const style = document.createElement('style');
        style.textContent = `
            @keyframes safeSakuraFall {
                0% {
                    transform: translateY(-100px) rotate(0deg);
                    opacity: 0.8;
                }
                100% {
                    transform: translateY(100vh) rotate(180deg);
                    opacity: 0;
                }
            }
            .safe-sakura {
                position: absolute;
                top: -50px;
                font-size: 18px;
                animation: safeSakuraFall linear forwards;
                user-select: none;
                pointer-events: none;
            }
        `;
        document.head.appendChild(style);
        
        let sakuraCount = 0;
        const maxSakuras = 10;
        
        function createSafeSakura() {
            if (sakuraCount >= maxSakuras) return;
            
            const sakura = document.createElement('div');
            sakura.className = 'safe-sakura';
            sakura.innerHTML = 'ðŸŒ¸';
            sakura.style.left = Math.random() * 100 + 'vw';
            sakura.style.fontSize = (16 + Math.random() * 16) + 'px';
            sakura.style.animationDuration = (10 + Math.random() * 10) + 's';
            sakura.style.animationDelay = (Math.random() * 3) + 's';
            
            container.appendChild(sakura);
            sakuraCount++;
            
            setTimeout(() => {
                if (sakura.parentNode) {
                    sakura.remove();
                    sakuraCount--;
                }
            }, 20000);
        }
        
        // å®‰å…¨åœ°å¯åŠ¨åŠ¨ç”»
        setTimeout(() => {
            setInterval(createSafeSakura, 1200);
            for (let i = 0; i < 5; i++) {
                setTimeout(createSafeSakura, i * 800);
            }
        }, 2000);
    }
})();
</script>