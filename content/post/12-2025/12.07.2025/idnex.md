---
title: 12-07 笔记
description: 夕阳无限好，只是近黄昏
date: 2025-12-07
slug: 12-07
image: bj.jpg
categories:
  - 每日 
---

111

函数的ABI规范

\- 参数通过 `rdi, rsi, rdx...` 传递
\- 返回值在 `rax`
\- `rbx, rbp, r12–r15` 是 callee-saved，其余是 caller-saved

寄存器的分类

| **参数/返回**            | `rdi`, `rsi`, `rdx`, `rcx`, `r8`, `r9`, `rax` | 传参 + 返回值                  |
| ------------------------ | --------------------------------------------- | ------------------------------ |
| **callee-saved**         | `rbx`, `rbp`, `r12–r15`                       | 可安全用于保存中间值           |
| **临时（caller-saved）** | `r10`, `r11`                                  | 自由使用，调用函数后可能被破坏 |

使用地址中的参数，注意要求导入的数据长度

多个参数的传递：

| 参数序号 | 寄存器（64位） | 32位形式 | 用途说明                    |
| -------- | -------------- | -------- | --------------------------- |
| 第1个    | `rdi`          | `edi`    | 常用于目标地址（如 `dest`） |
| 第2个    | `rsi`          | `esi`    | 常用于源地址（如 `src`）    |
| 第3个    | `rdx`          | `edx`    | 数据、长度等                |
| 第4个    | `rcx`          | `ecx`    | 计数、标志等                |
| 第5个    | `r8`           | `r8d`    | —                           |
| 第6个    | `r9`           | `r9d`    | —                           |

超过6个则需要使用栈传递（注意保持16字节对齐）

浮点数用XMM寄存器



函数中用栈使用数组时，需要对其清零

```
mov rcx, 0
clear_loop:
    mov word ptr [rsp + rcx*2], 0
    inc rcx
    cmp rcx, 256
    jl clear_loop
循环清零计数器，处理完rsp设定字节
```





IDA:

字符串定位

view -> open subviews -> strings

交叉引用窗口，找出什么代码使用了这个字符串

`X`

tab,F5 反汇编，

编译过程中给函数命的名会变为数字，反汇编窗口中可以进行重新命名,右键rename

左边框 ctrl + f 直接搜索函数名

 

如果有不可见字符，ida一般会用一个名字来代替返回的字符串



提取数据 lazyida

R键可以切换



基础加密：凯撒加密，异或加密

base64编码（使用64个可打印字符编码所有的数据）逆向，根据特征常量确定标准算法

特征常量，不变的字符串，

base64编码变表逆向

魔改表，利用base64编码原理，

```` 
data = ''
a = T5[T4.data(ch)]
````

在原编码表中找魔改码的位置，然后打印



ida 动态调试

![tiaoshiidad](tiaoshiidad.png)

不依赖于外部输入，每次输入后程序内部调取加密的字符串

执行程序，在12行处中断然后看str是什么

![debugchuangk](debugchuangk.png)

伪代码，寄存器，内存，栈

断点F2，步入F7，步过F8

利用动态调试观察某一些加密函数的返回值来判断加密类型
