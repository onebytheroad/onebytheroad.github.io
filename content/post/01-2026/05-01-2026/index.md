---
title: TLS
description: 
date: 2026-01-05
slug: 01-05-2026
image: bj.jpg
categories:
  - TLS
---

# TLS

## 一、什么是TLS

SSL，安全套接字层，一种网络安全协议。TLS，传输层安全协议，SSL的升级版，提供更安全的服务。

协议构建的可信通信通道

- **机密性**：通过非对称加密（RSA/ECC）和对称加密（AES/ChaCha20）确保数据仅对通信双方可见
- **完整性**：利用HMAC-SHA256等算法检测数据篡改
- **身份认证**：通过PKI体系验证服务器身份，防止中间人攻击

### 网络安全协议

一系列预先定义好的规则，标准和约定，用来在网络通信中保护数据，还用于通信双方的身份验证

## 二、TLS握手协议深度解析

### 完整握手流程（TLS 1.2示例）

1. **ClientHello**：发送随机数、支持的密码套件、扩展信息
2. **ServerHello**：选择协议版本、密码套件，发送服务器随机数
3. **Certificate**：发送证书链
4. **ServerKeyExchange**（可选）：DH参数或ECDHE参数
5. **ServerHelloDone**：标识服务器[消息](https://cloud.baidu.com/product/kafka.html)发送完毕
6. **ClientKeyExchange**：发送预主密钥（RSA）或计算公钥（ECDHE）
7. **ChangeCipherSpec**：通知切换加密状态
8. **Finished**：验证握手完整性

### 加密机制

TLS使用多种加密算法来保护数据传输的安全性，包括：

- **非对称加密**（如RSA、ECDHE）：用于密钥交换和身份认证。
- **对称加密**（如AES）：用于加密实际传输的数据，运算效率高。
- **哈希算法**（如SHA-256）：用于数据完整性校验，防止中间人攻击。

### 握手过程

在TCP通道上，开始进行TLS握手，目的是创建一把只有客户端和服务器知道的`会话密钥`，用来加密后续所有通信

1. 客户端向服务器发送：我支持什么样的TLS版本，加密套件（比如 AES_256_GCM， RSA）
2. 然后服务器选择一个加密套件，并讲自己的`数字证书`发送给客户端，数字证书里面包含了服务器的公钥，网站域名，以及证书颁发机构的数字签名
3. 客户端的浏览器内置了可信的CA根证书列表，它会用CA的公钥验证服务器证书的签名，确保证书不是伪造的，并且证书上的域名就是正在访问的网址，这是防止"钓鱼网站"的核心
4. 然后客户端会生成一个随机的对称会话密钥，接着用服务器证书里的公钥加密会话密钥，发送给服务器，服务器再用自己的私钥解密
   * **核心**：这里用了 **非对称加密**（RSA）：公钥加密，只有私钥能解，用来安全传递密钥。
   * **后续**：双方都有了同样的 **对称会话密钥**，后续将用更高效的 **对称加密**（AES）来加密实际数据。
5. 双方互相拥有密钥之后，再互相发送一条用新的会话密钥加密的握手完成的消息，如果成功，那此后所有的HTTP数据都将用这把对称密钥加密传送

## 三、证书

**SSL/TLS数字证书**是一种基于**公钥基础设施（PKI）[&的数字身份证，用于验证网站或服务器身份，并通过**SSL/TLS协议&]建立加密连接，确保数据在传输过程中**机密性、完整性和身份可信性**。

目前主流使用**TLS 1.2/1.3**，而“SSL”一词常作为SSL/TLS的统称。 证书由**证书颁发机构（CA）**签发，包含域名、公钥、颁发者信息、有效期等。浏览器通过验证证书链，确认服务器身份，并在握手阶段协商会话密钥，实现后续对称加密通信。

###  证书类型与选择

| 类型           | 验证级别     | 适用场景                   | 颁发速度 |
| -------------- | ------------ | -------------------------- | -------- |
| DV（域名验证） | 基础验证     | 个人博客、测试环境         | 分钟级   |
| OV（组织验证） | 企业信息验证 | 企业官网、内部系统         | 1-3天    |
| EV（扩展验证） | 严格法律验证 | 金融、电商等高安全需求场景 | 1-5天    |

### 证书链验证机制

浏览器验证过程：

1. 检查终端实体证书有效期
2. 验证签名算法强度（至少SHA256）
3. 追溯中间CA直至根证书
4. 校验CRL/OCSP吊销状态
